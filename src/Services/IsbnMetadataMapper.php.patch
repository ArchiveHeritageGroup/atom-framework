<?php
/**
 * Add to getPreviewData() method in IsbnMetadataMapper.php
 */

        // Cover images - prioritize Open Library direct URLs
        if (!empty($metadata['isbn_13']) || !empty($metadata['isbn_10'])) {
            $isbn = $metadata['isbn_13'] ?? $metadata['isbn_10'];
            $preview['cover_url'] = "https://covers.openlibrary.org/b/isbn/{$isbn}-M.jpg";
            $preview['cover_url_small'] = "https://covers.openlibrary.org/b/isbn/{$isbn}-S.jpg";
            $preview['cover_url_large'] = "https://covers.openlibrary.org/b/isbn/{$isbn}-L.jpg";
        } elseif (!empty($metadata['cover_url'])) {
            // Fallback to metadata cover if no ISBN
            $preview['cover_url'] = $metadata['cover_url'];
        }

        // Keep fallback URL from other sources
        if (!empty($metadata['cover_url_fallback'])) {
            $preview['cover_url_fallback'] = $metadata['cover_url_fallback'];
        }
